@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --glass-bg: 255 255 255 / 0.65;
  --glass-stroke: 17 24 39 / 0.08;
  --top-bar-min: 64px; /* минимальная высота верхней панели/кнопки */
  --top-gap: 24px;     /* дополнительный воздух */
  --tabbar-h: 64px;   /* высота плавающего таббара */
}

html, body, #__next {
  height: 100%;
}

/* Improve dynamic viewport handling for mobile full screen */
html, body {
  min-height: 100dvh;
  overscroll-behavior-y: none;
}

body {
  @apply bg-bg text-on antialiased;
  background-image: theme('backgroundImage.cosmic-gradient'), theme('backgroundImage.nebula-gradient');
  background-attachment: fixed;
  font-family: theme('fontFamily.sans');
  background-size: 200% 200%;
  animation: bg-pan 32s ease-in-out infinite alternate;
}

.glass {
  background: rgb(var(--glass-bg));
  border: 1px solid rgb(var(--glass-stroke));
  @apply backdrop-blur-md rounded-2xl shadow-glass;
}

.safe-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}
.safe-top {
  padding-top: calc(env(safe-area-inset-top) + var(--top-bar-min) + var(--top-gap));
}

/* Fallback, если env() недоступен */
@supports not (padding-top: env(safe-area-inset-top)) {
  .safe-top { padding-top: max(calc(var(--top-bar-min) + var(--top-gap)), 96px); }
}

/* Safe-area aware top padding with additional base spacing */
.safe-top-16 {
  padding-top: calc(env(safe-area-inset-top) + 16px);
}

/* Typography */
.typ-h1 { @apply font-sans; font-size: 28px; line-height: 34px; font-weight: 700; }
.typ-h2 { @apply font-sans; font-size: 22px; line-height: 28px; font-weight: 600; }
.typ-title { @apply font-sans; font-size: 18px; line-height: 24px; font-weight: 600; }
.typ-body { font-size: 16px; line-height: 22px; font-weight: 500; }
.typ-caption { font-size: 13px; line-height: 18px; font-weight: 500; }

@screen md {
  .typ-h1 { font-size: 34px; line-height: 40px; }
  .typ-h2 { font-size: 26px; line-height: 32px; }
}

/* Pastel gradient utility */
.pastel-gradient {
  background-image: linear-gradient(135deg, #E6D6FF, #FFD1DC 50%, #C6E6F5);
}

/* Scrim helper for images */
.scrim::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,0.18) 100%);
}

/* Compact rounded input style */
.input {
  @apply h-[46px] w-full px-3 py-2 rounded-xl bg-surface/90 border border-gray-200/60 shadow-sm placeholder:text-muted/70 text-on focus:outline-none focus-visible:ring-4 focus-visible:ring-accent/40 focus:border-accent transition;
}

/* Animated gradient background */
@keyframes bg-pan {
  0% { background-position: 0% 0%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 100%; }
}

/* Text gradient animation for headings */
.text-gradient-soft {
  background: linear-gradient(90deg, rgba(15,16,32,1), rgba(107,114,128,1), rgba(15,16,32,1));
  background-size: 200% auto;
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  animation: text-gradient 8s ease-in-out infinite alternate;
}
@keyframes text-gradient {
  0% { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}

/* Polaroid-like reveal */
.animate-polaroid {
  animation: polaroid-in 420ms cubic-bezier(0.2, 0.7, 0.2, 1) both;
}
@keyframes polaroid-in {
  0% { opacity: 0; transform: scale(0.98) translateY(8px); filter: blur(2px); }
  100% { opacity: 1; transform: scale(1) translateY(0); filter: blur(0); }
}

/* Cosmic dust: subtle parallax star layers */
.cosmic-dust { position: absolute; inset: 0; overflow: hidden; pointer-events: none; }
.cosmic-dust::before,
.cosmic-dust::after {
  content: '';
  position: absolute;
  inset: -20% -10%;
  background-image:
    radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.20) 50%, transparent 51%),
    radial-gradient(1.5px 1.5px at 70% 60%, rgba(255,255,255,0.16) 50%, transparent 51%),
    radial-gradient(1.2px 1.2px at 40% 80%, rgba(255,255,255,0.12) 50%, transparent 51%),
    radial-gradient(1px 1px at 85% 25%, rgba(255,255,255,0.12) 50%, transparent 51%);
  opacity: .15;
  transform: translateY(0);
}
.cosmic-dust::before { animation: dust-drift 60s linear infinite; }
.cosmic-dust::after { animation: dust-drift-rev 80s linear infinite; opacity: .12; }
@keyframes dust-drift { from { transform: translateY(-4%); } to { transform: translateY(4%); } }
@keyframes dust-drift-rev { from { transform: translateY(4%); } to { transform: translateY(-4%); } }